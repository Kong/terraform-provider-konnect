---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_mesh_metric Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  MeshMetric Resource
---

# konnect_mesh_metric (Resource)

MeshMetric Resource

## Example Usage

```terraform
resource "konnect_mesh_metric" "my_meshmetric" {
  cp_id = "bf138ba2-c9b1-4229-b268-04d9d8a6410b"
  labels = {
    key = "value",
  }
  mesh = "...my_mesh..."
  name = "...my_name..."
  spec = {
    default = {
      applications = [
        {
          address = "...my_address..."
          name    = "...my_name..."
          path    = "...my_path..."
          port    = 8
        }
      ]
      backends = [
        {
          open_telemetry = {
            endpoint         = "...my_endpoint..."
            refresh_interval = "...my_refresh_interval..."
          }
          prometheus = {
            client_id = "...my_client_id..."
            path      = "...my_path..."
            port      = 7
            tls = {
              mode = "Disabled"
            }
          }
          type = "Prometheus"
        }
      ]
      sidecar = {
        include_unused = false
        profiles = {
          append_profiles = [
            {
              name = "Basic"
            }
          ]
          exclude = [
            {
              match = "...my_match..."
              type  = "Contains"
            }
          ]
          include = [
            {
              match = "...my_match..."
              type  = "Regex"
            }
          ]
        }
      }
    }
    target_ref = {
      kind = "MeshSubset"
      labels = {
        key = "value",
      }
      mesh      = "...my_mesh..."
      name      = "...my_name..."
      namespace = "...my_namespace..."
      proxy_types = [
        "Gateway"
      ]
      section_name = "...my_section_name..."
      tags = {
        key = "value",
      }
    }
  }
  type = "MeshMetric"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cp_id` (String) Id of the Konnect resource
- `mesh` (String) name of the mesh
- `name` (String) name of the MeshMetric
- `spec` (Attributes) Spec is the specification of the Kuma MeshMetric resource. (see [below for nested schema](#nestedatt--spec))
- `type` (String) the type of the resource. must be "MeshMetric"

### Optional

- `labels` (Map of String) The labels to help identity resources

### Read-Only

- `creation_time` (String) Time at which the resource was created
- `modification_time` (String) Time at which the resource was updated
- `warnings` (List of String) warnings is a list of warning messages to return to the requesting Kuma API clients.
Warning messages describe a problem the client making the API request should correct or be aware of.

<a id="nestedatt--spec"></a>
### Nested Schema for `spec`

Optional:

- `default` (Attributes) MeshMetric configuration. (see [below for nested schema](#nestedatt--spec--default))
- `target_ref` (Attributes) TargetRef is a reference to the resource the policy takes an effect on.
The resource could be either a real store object or virtual resource
defined in-place. (see [below for nested schema](#nestedatt--spec--target_ref))

<a id="nestedatt--spec--default"></a>
### Nested Schema for `spec.default`

Optional:

- `applications` (Attributes List) Applications is a list of application that Dataplane Proxy will scrape (see [below for nested schema](#nestedatt--spec--default--applications))
- `backends` (Attributes List) Backends list that will be used to collect metrics. (see [below for nested schema](#nestedatt--spec--default--backends))
- `sidecar` (Attributes) Sidecar metrics collection configuration (see [below for nested schema](#nestedatt--spec--default--sidecar))

<a id="nestedatt--spec--default--applications"></a>
### Nested Schema for `spec.default.applications`

Optional:

- `address` (String) Address on which an application listens.
- `name` (String) Name of the application to scrape
- `path` (String) Path on which an application expose HTTP endpoint with metrics. Default: "/metrics"
- `port` (Number) Port on which an application expose HTTP endpoint with metrics. Not Null


<a id="nestedatt--spec--default--backends"></a>
### Nested Schema for `spec.default.backends`

Optional:

- `open_telemetry` (Attributes) OpenTelemetry backend configuration (see [below for nested schema](#nestedatt--spec--default--backends--open_telemetry))
- `prometheus` (Attributes) Prometheus backend configuration. (see [below for nested schema](#nestedatt--spec--default--backends--prometheus))
- `type` (String) Type of the backend that will be used to collect metrics. At the moment only Prometheus backend is available. Not Null; must be one of ["Prometheus", "OpenTelemetry"]

<a id="nestedatt--spec--default--backends--open_telemetry"></a>
### Nested Schema for `spec.default.backends.open_telemetry`

Optional:

- `endpoint` (String) Endpoint for OpenTelemetry collector. Not Null
- `refresh_interval` (String) RefreshInterval defines how frequent metrics should be pushed to collector


<a id="nestedatt--spec--default--backends--prometheus"></a>
### Nested Schema for `spec.default.backends.prometheus`

Optional:

- `client_id` (String) ClientId of the Prometheus backend. Needed when using MADS for DP discovery.
- `path` (String) Path on which a dataplane should expose HTTP endpoint with Prometheus metrics. Default: "/metrics"
- `port` (Number) Port on which a dataplane should expose HTTP endpoint with Prometheus metrics. Default: 5670
- `tls` (Attributes) Configuration of TLS for prometheus listener. (see [below for nested schema](#nestedatt--spec--default--backends--prometheus--tls))

<a id="nestedatt--spec--default--backends--prometheus--tls"></a>
### Nested Schema for `spec.default.backends.prometheus.tls`

Optional:

- `mode` (String) Configuration of TLS for Prometheus listener. Default: "Disabled"; must be one of ["Disabled", "ProvidedTLS", "ActiveMTLSBackend"]




<a id="nestedatt--spec--default--sidecar"></a>
### Nested Schema for `spec.default.sidecar`

Optional:

- `include_unused` (Boolean) IncludeUnused if false will scrape only metrics that has been by sidecar (counters incremented
at least once, gauges changed at least once, and histograms added to at
least once). If true will scrape all metrics (even the ones with zeros).
If not specified then the default value is false.
- `profiles` (Attributes) Profiles allows to customize which metrics are published. (see [below for nested schema](#nestedatt--spec--default--sidecar--profiles))

<a id="nestedatt--spec--default--sidecar--profiles"></a>
### Nested Schema for `spec.default.sidecar.profiles`

Optional:

- `append_profiles` (Attributes List) AppendProfiles allows to combine the metrics from multiple predefined profiles. (see [below for nested schema](#nestedatt--spec--default--sidecar--profiles--append_profiles))
- `exclude` (Attributes List) Exclude makes it possible to exclude groups of metrics from a resulting profile.
Exclude is subordinate to Include. (see [below for nested schema](#nestedatt--spec--default--sidecar--profiles--exclude))
- `include` (Attributes List) Include makes it possible to include additional metrics in a selected profiles.
Include takes precedence over Exclude. (see [below for nested schema](#nestedatt--spec--default--sidecar--profiles--include))

<a id="nestedatt--spec--default--sidecar--profiles--append_profiles"></a>
### Nested Schema for `spec.default.sidecar.profiles.append_profiles`

Optional:

- `name` (String) Name of the predefined profile, one of: all, basic, none. Not Null; must be one of ["All", "Basic", "None"]


<a id="nestedatt--spec--default--sidecar--profiles--exclude"></a>
### Nested Schema for `spec.default.sidecar.profiles.exclude`

Optional:

- `match` (String) Match is the value used to match using particular Type. Not Null
- `type` (String) Type defined the type of selector, one of: prefix, regex, exact. Not Null; must be one of ["Prefix", "Regex", "Exact", "Contains"]


<a id="nestedatt--spec--default--sidecar--profiles--include"></a>
### Nested Schema for `spec.default.sidecar.profiles.include`

Optional:

- `match` (String) Match is the value used to match using particular Type. Not Null
- `type` (String) Type defined the type of selector, one of: prefix, regex, exact. Not Null; must be one of ["Prefix", "Regex", "Exact", "Contains"]





<a id="nestedatt--spec--target_ref"></a>
### Nested Schema for `spec.target_ref`

Required:

- `kind` (String) Kind of the referenced resource. must be one of ["Mesh", "MeshSubset", "MeshGateway", "MeshService", "MeshExternalService", "MeshMultiZoneService", "MeshServiceSubset", "MeshHTTPRoute", "Dataplane"]

Optional:

- `labels` (Map of String) Labels are used to select group of MeshServices that match labels. Either Labels or
Name and Namespace can be used.
- `mesh` (String) Mesh is reserved for future use to identify cross mesh resources.
- `name` (String) Name of the referenced resource. Can only be used with kinds: `MeshService`,
`MeshServiceSubset` and `MeshGatewayRoute`
- `namespace` (String) Namespace specifies the namespace of target resource. If empty only resources in policy namespace
will be targeted.
- `proxy_types` (List of String) ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
all data plane types are targeted by the policy.
- `section_name` (String) SectionName is used to target specific section of resource.
For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
- `tags` (Map of String) Tags used to select a subset of proxies by tags. Can only be used with kinds
`MeshSubset` and `MeshServiceSubset`

## Import

Import is supported using the following syntax:

```shell
terraform import konnect_mesh_metric.my_konnect_mesh_metric "{ \"cp_id\": \"bf138ba2-c9b1-4229-b268-04d9d8a6410b\",  \"mesh\": \"\",  \"name\": \"\"}"
```
