---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_gateway_upstream Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  GatewayUpstream Resource
---

# konnect_gateway_upstream (Resource)

GatewayUpstream Resource

## Example Usage

```terraform
resource "konnect_gateway_upstream" "my_gatewayupstream" {
  algorithm = "latency"
  client_certificate = {
    id = "...my_id..."
  }
  control_plane_id          = "9524ec7d-36d9-465d-a8c5-83a3c9390458"
  hash_fallback             = "path"
  hash_fallback_header      = "...my_hash_fallback_header..."
  hash_fallback_query_arg   = "...my_hash_fallback_query_arg..."
  hash_fallback_uri_capture = "...my_hash_fallback_uri_capture..."
  hash_on                   = "header"
  hash_on_cookie            = "...my_hash_on_cookie..."
  hash_on_cookie_path       = "...my_hash_on_cookie_path..."
  hash_on_header            = "...my_hash_on_header..."
  hash_on_query_arg         = "...my_hash_on_query_arg..."
  hash_on_uri_capture       = "...my_hash_on_uri_capture..."
  healthchecks = {
    active = {
      concurrency = 6
      headers = {
        key = "value"
      }
      healthy = {
        http_statuses = [
          0
        ]
        interval  = 8.45
        successes = 8
      }
      http_path                = "...my_http_path..."
      https_sni                = "...my_https_sni..."
      https_verify_certificate = true
      timeout                  = 9.02
      type                     = "https"
      unhealthy = {
        http_failures = 8
        http_statuses = [
          3
        ]
        interval     = 4.15
        tcp_failures = 3
        timeouts     = 7
      }
    }
    passive = {
      healthy = {
        http_statuses = [
          0
        ]
        successes = 8
      }
      type = "grpcs"
      unhealthy = {
        http_failures = 10
        http_statuses = [
          9
        ]
        tcp_failures = 10
        timeouts     = 0
      }
    }
    threshold = 3.63
  }
  host_header = "...my_host_header..."
  id          = "...my_id..."
  name        = "...my_name..."
  slots       = 0
  tags = [
    "..."
  ]
  use_srv_name = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `control_plane_id` (String) The UUID of your control plane. This variable is available in the Konnect manager. Requires replacement if changed.
- `name` (String) This is a hostname, which must be equal to the `host` of a Service.

### Optional

- `algorithm` (String) Which load balancing algorithm to use. must be one of ["consistent-hashing", "least-connections", "round-robin", "latency"]
- `client_certificate` (Attributes) If set, the certificate to be used as client certificate while TLS handshaking to the upstream server. (see [below for nested schema](#nestedatt--client_certificate))
- `hash_fallback` (String) What to use as hashing input if the primary `hash_on` does not return a hash (eg. header is missing, or no Consumer identified). Not available if `hash_on` is set to `cookie`. must be one of ["none", "consumer", "ip", "header", "cookie", "path", "query_arg", "uri_capture"]
- `hash_fallback_header` (String) The header name to take the value from as hash input. Only required when `hash_fallback` is set to `header`.
- `hash_fallback_query_arg` (String) The name of the query string argument to take the value from as hash input. Only required when `hash_fallback` is set to `query_arg`.
- `hash_fallback_uri_capture` (String) The name of the route URI capture to take the value from as hash input. Only required when `hash_fallback` is set to `uri_capture`.
- `hash_on` (String) What to use as hashing input. Using `none` results in a weighted-round-robin scheme with no hashing. must be one of ["none", "consumer", "ip", "header", "cookie", "path", "query_arg", "uri_capture"]
- `hash_on_cookie` (String) The cookie name to take the value from as hash input. Only required when `hash_on` or `hash_fallback` is set to `cookie`. If the specified cookie is not in the request, Kong will generate a value and set the cookie in the response.
- `hash_on_cookie_path` (String) The cookie path to set in the response headers. Only required when `hash_on` or `hash_fallback` is set to `cookie`.
- `hash_on_header` (String) The header name to take the value from as hash input. Only required when `hash_on` is set to `header`.
- `hash_on_query_arg` (String) The name of the query string argument to take the value from as hash input. Only required when `hash_on` is set to `query_arg`.
- `hash_on_uri_capture` (String) The name of the route URI capture to take the value from as hash input. Only required when `hash_on` is set to `uri_capture`.
- `healthchecks` (Attributes) (see [below for nested schema](#nestedatt--healthchecks))
- `host_header` (String) The hostname to be used as `Host` header when proxying requests through Kong.
- `slots` (Number) The number of slots in the load balancer algorithm. If `algorithm` is set to `round-robin`, this setting determines the maximum number of slots. If `algorithm` is set to `consistent-hashing`, this setting determines the actual number of slots in the algorithm. Accepts an integer in the range `10`-`65536`.
- `tags` (List of String) An optional set of strings associated with the Upstream for grouping and filtering.
- `use_srv_name` (Boolean) If set, the balancer will use SRV hostname(if DNS Answer has SRV record) as the proxy upstream `Host`.

### Read-Only

- `created_at` (Number) Unix epoch when the resource was created.
- `id` (String) The ID of this resource.
- `updated_at` (Number) Unix epoch when the resource was last updated.

<a id="nestedatt--client_certificate"></a>
### Nested Schema for `client_certificate`

Optional:

- `id` (String)


<a id="nestedatt--healthchecks"></a>
### Nested Schema for `healthchecks`

Optional:

- `active` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active))
- `passive` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive))
- `threshold` (Number)

<a id="nestedatt--healthchecks--active"></a>
### Nested Schema for `healthchecks.active`

Optional:

- `concurrency` (Number)
- `headers` (Map of String)
- `healthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active--healthy))
- `http_path` (String)
- `https_sni` (String)
- `https_verify_certificate` (Boolean)
- `timeout` (Number)
- `type` (String) must be one of ["tcp", "http", "https", "grpc", "grpcs"]
- `unhealthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active--unhealthy))

<a id="nestedatt--healthchecks--active--healthy"></a>
### Nested Schema for `healthchecks.active.healthy`

Optional:

- `http_statuses` (List of Number)
- `interval` (Number)
- `successes` (Number)


<a id="nestedatt--healthchecks--active--unhealthy"></a>
### Nested Schema for `healthchecks.active.unhealthy`

Optional:

- `http_failures` (Number)
- `http_statuses` (List of Number)
- `interval` (Number)
- `tcp_failures` (Number)
- `timeouts` (Number)



<a id="nestedatt--healthchecks--passive"></a>
### Nested Schema for `healthchecks.passive`

Optional:

- `healthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive--healthy))
- `type` (String) must be one of ["tcp", "http", "https", "grpc", "grpcs"]
- `unhealthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive--unhealthy))

<a id="nestedatt--healthchecks--passive--healthy"></a>
### Nested Schema for `healthchecks.passive.healthy`

Optional:

- `http_statuses` (List of Number)
- `successes` (Number)


<a id="nestedatt--healthchecks--passive--unhealthy"></a>
### Nested Schema for `healthchecks.passive.unhealthy`

Optional:

- `http_failures` (Number)
- `http_statuses` (List of Number)
- `tcp_failures` (Number)
- `timeouts` (Number)

## Import

Import is supported using the following syntax:

```shell
terraform import konnect_gateway_upstream.my_konnect_gateway_upstream "{ \"control_plane_id\": \"9524ec7d-36d9-465d-a8c5-83a3c9390458\",  \"upstream_id\": \"426d620c-7058-4ae6-aacc-f85a3204a2c5\"}"
```
