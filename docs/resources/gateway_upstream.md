---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_gateway_upstream Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  GatewayUpstream Resource
---

# konnect_gateway_upstream (Resource)

GatewayUpstream Resource

## Example Usage

```terraform
resource "konnect_gateway_upstream" "my_gatewayupstream" {
  algorithm = "sticky-sessions"
  client_certificate = {
    id = "...my_id..."
  }
  control_plane_id          = "9524ec7d-36d9-465d-a8c5-83a3c9390458"
  created_at                = 5
  hash_fallback             = "path"
  hash_fallback_header      = "...my_hash_fallback_header..."
  hash_fallback_query_arg   = "...my_hash_fallback_query_arg..."
  hash_fallback_uri_capture = "...my_hash_fallback_uri_capture..."
  hash_on                   = "ip"
  hash_on_cookie            = "...my_hash_on_cookie..."
  hash_on_cookie_path       = "...my_hash_on_cookie_path..."
  hash_on_header            = "...my_hash_on_header..."
  hash_on_query_arg         = "...my_hash_on_query_arg..."
  hash_on_uri_capture       = "...my_hash_on_uri_capture..."
  healthchecks = {
    active = {
      concurrency = 1225225904
      headers = {
        key = [
          # ...
        ]
      }
      healthy = {
        http_statuses = [
          179
        ]
        interval  = 55332.9
        successes = 196
      }
      http_path                = "...my_http_path..."
      https_sni                = "...my_https_sni..."
      https_verify_certificate = true
      timeout                  = 59064.97
      type                     = "http"
      unhealthy = {
        http_failures = 207
        http_statuses = [
          396
        ]
        interval     = 27179.84
        tcp_failures = 92
        timeouts     = 183
      }
    }
    passive = {
      healthy = {
        http_statuses = [
          135
        ]
        successes = 189
      }
      type = "tcp"
      unhealthy = {
        http_failures = 249
        http_statuses = [
          865
        ]
        tcp_failures = 234
        timeouts     = 21
      }
    }
    threshold = 36.29
  }
  host_header                 = "...my_host_header..."
  id                          = "...my_id..."
  name                        = "...my_name..."
  slots                       = 4503
  sticky_sessions_cookie      = "...my_sticky_sessions_cookie..."
  sticky_sessions_cookie_path = "...my_sticky_sessions_cookie_path..."
  tags = [
    "..."
  ]
  updated_at   = 1
  use_srv_name = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `control_plane_id` (String) The UUID of your control plane. This variable is available in the Konnect manager. Requires replacement if changed.
- `name` (String) This is a hostname, which must be equal to the `host` of a Service.

### Optional

- `algorithm` (String) Which load balancing algorithm to use. Default: "round-robin"; must be one of ["consistent-hashing", "latency", "least-connections", "round-robin", "sticky-sessions"]
- `client_certificate` (Attributes) If set, the certificate to be used as client certificate while TLS handshaking to the upstream server. (see [below for nested schema](#nestedatt--client_certificate))
- `created_at` (Number) Unix epoch when the resource was created.
- `hash_fallback` (String) What to use as hashing input if the primary `hash_on` does not return a hash (eg. header is missing, or no Consumer identified). Not available if `hash_on` is set to `cookie`. Default: "none"; must be one of ["consumer", "cookie", "header", "ip", "none", "path", "query_arg", "uri_capture"]
- `hash_fallback_header` (String) The header name to take the value from as hash input. Only required when `hash_fallback` is set to `header`.
- `hash_fallback_query_arg` (String) The name of the query string argument to take the value from as hash input. Only required when `hash_fallback` is set to `query_arg`.
- `hash_fallback_uri_capture` (String) The name of the route URI capture to take the value from as hash input. Only required when `hash_fallback` is set to `uri_capture`.
- `hash_on` (String) What to use as hashing input. Using `none` results in a weighted-round-robin scheme with no hashing. Default: "none"; must be one of ["consumer", "cookie", "header", "ip", "none", "path", "query_arg", "uri_capture"]
- `hash_on_cookie` (String) The cookie name to take the value from as hash input. Only required when `hash_on` or `hash_fallback` is set to `cookie`. If the specified cookie is not in the request, Kong will generate a value and set the cookie in the response.
- `hash_on_cookie_path` (String) The cookie path to set in the response headers. Only required when `hash_on` or `hash_fallback` is set to `cookie`. Default: "/"
- `hash_on_header` (String) The header name to take the value from as hash input. Only required when `hash_on` is set to `header`.
- `hash_on_query_arg` (String) The name of the query string argument to take the value from as hash input. Only required when `hash_on` is set to `query_arg`.
- `hash_on_uri_capture` (String) The name of the route URI capture to take the value from as hash input. Only required when `hash_on` is set to `uri_capture`.
- `healthchecks` (Attributes) The array of healthchecks. (see [below for nested schema](#nestedatt--healthchecks))
- `host_header` (String) The hostname to be used as `Host` header when proxying requests through Kong.
- `id` (String) A string representing a UUID (universally unique identifier).
- `slots` (Number) The number of slots in the load balancer algorithm. If `algorithm` is set to `round-robin`, this setting determines the maximum number of slots. If `algorithm` is set to `consistent-hashing`, this setting determines the actual number of slots in the algorithm. Accepts an integer in the range `10`-`65536`. Default: 10000
- `sticky_sessions_cookie` (String) The cookie name to keep sticky sessions.
- `sticky_sessions_cookie_path` (String) A string representing a URL path, such as /path/to/resource. Must start with a forward slash (/) and must not contain empty segments (i.e., two consecutive forward slashes). Default: "/"
- `tags` (List of String) An optional set of strings associated with the Upstream for grouping and filtering.
- `updated_at` (Number) Unix epoch when the resource was last updated.
- `use_srv_name` (Boolean) If set, the balancer will use SRV hostname(if DNS Answer has SRV record) as the proxy upstream `Host`. Default: false

<a id="nestedatt--client_certificate"></a>
### Nested Schema for `client_certificate`

Optional:

- `id` (String)


<a id="nestedatt--healthchecks"></a>
### Nested Schema for `healthchecks`

Optional:

- `active` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active))
- `passive` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive))
- `threshold` (Number) Default: 0

<a id="nestedatt--healthchecks--active"></a>
### Nested Schema for `healthchecks.active`

Optional:

- `concurrency` (Number) Default: 10
- `headers` (Map of List of String) A map of header names to arrays of header values.
- `healthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active--healthy))
- `http_path` (String) A string representing a URL path, such as /path/to/resource. Must start with a forward slash (/) and must not contain empty segments (i.e., two consecutive forward slashes). Default: "/"
- `https_sni` (String) A string representing an SNI (server name indication) value for TLS.
- `https_verify_certificate` (Boolean) Default: true
- `timeout` (Number) Default: 1
- `type` (String) Default: "http"; must be one of ["grpc", "grpcs", "http", "https", "tcp"]
- `unhealthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--active--unhealthy))

<a id="nestedatt--healthchecks--active--healthy"></a>
### Nested Schema for `healthchecks.active.healthy`

Optional:

- `http_statuses` (List of Number)
- `interval` (Number) Default: 0
- `successes` (Number) Default: 0


<a id="nestedatt--healthchecks--active--unhealthy"></a>
### Nested Schema for `healthchecks.active.unhealthy`

Optional:

- `http_failures` (Number) Default: 0
- `http_statuses` (List of Number)
- `interval` (Number) Default: 0
- `tcp_failures` (Number) Default: 0
- `timeouts` (Number) Default: 0



<a id="nestedatt--healthchecks--passive"></a>
### Nested Schema for `healthchecks.passive`

Optional:

- `healthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive--healthy))
- `type` (String) Default: "http"; must be one of ["grpc", "grpcs", "http", "https", "tcp"]
- `unhealthy` (Attributes) (see [below for nested schema](#nestedatt--healthchecks--passive--unhealthy))

<a id="nestedatt--healthchecks--passive--healthy"></a>
### Nested Schema for `healthchecks.passive.healthy`

Optional:

- `http_statuses` (List of Number)
- `successes` (Number) Default: 0


<a id="nestedatt--healthchecks--passive--unhealthy"></a>
### Nested Schema for `healthchecks.passive.unhealthy`

Optional:

- `http_failures` (Number) Default: 0
- `http_statuses` (List of Number)
- `tcp_failures` (Number) Default: 0
- `timeouts` (Number) Default: 0

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = konnect_gateway_upstream.my_konnect_gateway_upstream
  id = jsonencode({
    control_plane_id = "9524ec7d-36d9-465d-a8c5-83a3c9390458"
    id = "426d620c-7058-4ae6-aacc-f85a3204a2c5"
  })
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import konnect_gateway_upstream.my_konnect_gateway_upstream '{"control_plane_id": "9524ec7d-36d9-465d-a8c5-83a3c9390458", "id": "426d620c-7058-4ae6-aacc-f85a3204a2c5"}'
```
