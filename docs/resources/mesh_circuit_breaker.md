---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_mesh_circuit_breaker Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  MeshCircuitBreaker Resource
---

# konnect_mesh_circuit_breaker (Resource)

MeshCircuitBreaker Resource

## Example Usage

```terraform
resource "konnect_mesh_circuit_breaker" "my_meshcircuitbreaker" {
  cp_id = "bf138ba2-c9b1-4229-b268-04d9d8a6410b"
  labels = {
    key = "value",
  }
  mesh = "...my_mesh..."
  name = "...my_name..."
  spec = {
    from = [
      {
        default = {
          connection_limits = {
            max_connection_pools = 9
            max_connections      = 1
            max_pending_requests = 3
            max_requests         = 7
            max_retries          = 3
          }
          outlier_detection = {
            base_ejection_time = "...my_base_ejection_time..."
            detectors = {
              failure_percentage = {
                minimum_hosts  = 7
                request_volume = 5
                threshold      = 1
              }
              gateway_failures = {
                consecutive = 2
              }
              local_origin_failures = {
                consecutive = 0
              }
              success_rate = {
                minimum_hosts  = 9
                request_volume = 6
                standard_deviation_factor = {
                  integer = 8
                  str     = "...my_str..."
                }
              }
              total_failures = {
                consecutive = 7
              }
            }
            disabled = false
            healthy_panic_threshold = {
              integer = 9
              str     = "...my_str..."
            }
            interval                        = "...my_interval..."
            max_ejection_percent            = 9
            split_external_and_local_errors = true
          }
        }
        target_ref = {
          kind = "MeshHTTPRoute"
          labels = {
            key = "value",
          }
          mesh      = "...my_mesh..."
          name      = "...my_name..."
          namespace = "...my_namespace..."
          proxy_types = [
            "Sidecar"
          ]
          section_name = "...my_section_name..."
          tags = {
            key = "value",
          }
        }
      }
    ]
    rules = [
      {
        default = {
          connection_limits = {
            max_connection_pools = 6
            max_connections      = 10
            max_pending_requests = 0
            max_requests         = 0
            max_retries          = 5
          }
          outlier_detection = {
            base_ejection_time = "...my_base_ejection_time..."
            detectors = {
              failure_percentage = {
                minimum_hosts  = 6
                request_volume = 1
                threshold      = 6
              }
              gateway_failures = {
                consecutive = 0
              }
              local_origin_failures = {
                consecutive = 7
              }
              success_rate = {
                minimum_hosts  = 8
                request_volume = 9
                standard_deviation_factor = {
                  integer = 6
                  str     = "...my_str..."
                }
              }
              total_failures = {
                consecutive = 9
              }
            }
            disabled = false
            healthy_panic_threshold = {
              integer = 2
              str     = "...my_str..."
            }
            interval                        = "...my_interval..."
            max_ejection_percent            = 1
            split_external_and_local_errors = false
          }
        }
      }
    ]
    target_ref = {
      kind = "MeshSubset"
      labels = {
        key = "value",
      }
      mesh      = "...my_mesh..."
      name      = "...my_name..."
      namespace = "...my_namespace..."
      proxy_types = [
        "Gateway"
      ]
      section_name = "...my_section_name..."
      tags = {
        key = "value",
      }
    }
    to = [
      {
        default = {
          connection_limits = {
            max_connection_pools = 4
            max_connections      = 8
            max_pending_requests = 3
            max_requests         = 2
            max_retries          = 3
          }
          outlier_detection = {
            base_ejection_time = "...my_base_ejection_time..."
            detectors = {
              failure_percentage = {
                minimum_hosts  = 1
                request_volume = 10
                threshold      = 0
              }
              gateway_failures = {
                consecutive = 10
              }
              local_origin_failures = {
                consecutive = 5
              }
              success_rate = {
                minimum_hosts  = 9
                request_volume = 3
                standard_deviation_factor = {
                  integer = 10
                  str     = "...my_str..."
                }
              }
              total_failures = {
                consecutive = 2
              }
            }
            disabled = true
            healthy_panic_threshold = {
              integer = 8
              str     = "...my_str..."
            }
            interval                        = "...my_interval..."
            max_ejection_percent            = 4
            split_external_and_local_errors = true
          }
        }
        target_ref = {
          kind = "MeshGateway"
          labels = {
            key = "value",
          }
          mesh      = "...my_mesh..."
          name      = "...my_name..."
          namespace = "...my_namespace..."
          proxy_types = [
            "Sidecar"
          ]
          section_name = "...my_section_name..."
          tags = {
            key = "value",
          }
        }
      }
    ]
  }
  type = "MeshCircuitBreaker"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cp_id` (String) Id of the Konnect resource
- `mesh` (String) name of the mesh
- `name` (String) name of the MeshCircuitBreaker
- `spec` (Attributes) Spec is the specification of the Kuma MeshCircuitBreaker resource. (see [below for nested schema](#nestedatt--spec))
- `type` (String) the type of the resource. must be "MeshCircuitBreaker"

### Optional

- `labels` (Map of String) The labels to help identity resources

### Read-Only

- `creation_time` (String) Time at which the resource was created
- `modification_time` (String) Time at which the resource was updated
- `warnings` (List of String) warnings is a list of warning messages to return to the requesting Kuma API clients.
Warning messages describe a problem the client making the API request should correct or be aware of.

<a id="nestedatt--spec"></a>
### Nested Schema for `spec`

Optional:

- `from` (Attributes List) From list makes a match between clients and corresponding configurations (see [below for nested schema](#nestedatt--spec--from))
- `rules` (Attributes List) Rules defines inbound circuit breaker configurations. Currently limited to
selecting all inbound traffic, as L7 matching is not yet implemented. (see [below for nested schema](#nestedatt--spec--rules))
- `target_ref` (Attributes) TargetRef is a reference to the resource the policy takes an effect on.
The resource could be either a real store object or virtual resource
defined in place. (see [below for nested schema](#nestedatt--spec--target_ref))
- `to` (Attributes List) To list makes a match between the consumed services and corresponding
configurations (see [below for nested schema](#nestedatt--spec--to))

<a id="nestedatt--spec--from"></a>
### Nested Schema for `spec.from`

Optional:

- `default` (Attributes) Default is a configuration specific to the group of destinations
referenced in 'targetRef' (see [below for nested schema](#nestedatt--spec--from--default))
- `target_ref` (Attributes) TargetRef is a reference to the resource that represents a group of
destinations.
Not Null (see [below for nested schema](#nestedatt--spec--from--target_ref))

<a id="nestedatt--spec--from--default"></a>
### Nested Schema for `spec.from.default`

Optional:

- `connection_limits` (Attributes) ConnectionLimits contains configuration of each circuit breaking limit,
which when exceeded makes the circuit breaker to become open (no traffic
is allowed like no current is allowed in the circuits when physical
circuit breaker ir open) (see [below for nested schema](#nestedatt--spec--from--default--connection_limits))
- `outlier_detection` (Attributes) OutlierDetection contains the configuration of the process of dynamically
determining whether some number of hosts in an upstream cluster are
performing unlike the others and removing them from the healthy load
balancing set. Performance might be along different axes such as
consecutive failures, temporal success rate, temporal latency, etc.
Outlier detection is a form of passive health checking. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection))

<a id="nestedatt--spec--from--default--connection_limits"></a>
### Nested Schema for `spec.from.default.connection_limits`

Optional:

- `max_connection_pools` (Number) The maximum number of connection pools per cluster that are concurrently
supported at once. Set this for clusters which create a large number of
connection pools.
- `max_connections` (Number) The maximum number of connections allowed to be made to the upstream
cluster.
- `max_pending_requests` (Number) The maximum number of pending requests that are allowed to the upstream
cluster. This limit is applied as a connection limit for non-HTTP
traffic.
- `max_requests` (Number) The maximum number of parallel requests that are allowed to be made
to the upstream cluster. This limit does not apply to non-HTTP traffic.
- `max_retries` (Number) The maximum number of parallel retries that will be allowed to
the upstream cluster.


<a id="nestedatt--spec--from--default--outlier_detection"></a>
### Nested Schema for `spec.from.default.outlier_detection`

Optional:

- `base_ejection_time` (String) The base time that a host is ejected for. The real time is equal to
the base time multiplied by the number of times the host has been
ejected.
- `detectors` (Attributes) Contains configuration for supported outlier detectors (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors))
- `disabled` (Boolean) When set to true, outlierDetection configuration won't take any effect
- `healthy_panic_threshold` (Attributes) Allows to configure panic threshold for Envoy cluster. If not specified,
the default is 50%. To disable panic mode, set to 0%.
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--healthy_panic_threshold))
- `interval` (String) The time interval between ejection analysis sweeps. This can result in
both new ejections and hosts being returned to service.
- `max_ejection_percent` (Number) The maximum % of an upstream cluster that can be ejected due to outlier
detection. Defaults to 10% but will eject at least one host regardless of
the value.
- `split_external_and_local_errors` (Boolean) Determines whether to distinguish local origin failures from external
errors. If set to true the following configuration parameters are taken
into account: detectors.localOriginFailures.consecutive

<a id="nestedatt--spec--from--default--outlier_detection--detectors"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors`

Optional:

- `failure_percentage` (Attributes) Failure Percentage based outlier detection functions similarly to success
rate detection, in that it relies on success rate data from each host in
a cluster. However, rather than compare those values to the mean success
rate of the cluster as a whole, they are compared to a flat
user-configured threshold. This threshold is configured via the
outlierDetection.failurePercentageThreshold field.
The other configuration fields for failure percentage based detection are
similar to the fields for success rate detection. As with success rate
detection, detection will not be performed for a host if its request
volume over the aggregation interval is less than the
outlierDetection.detectors.failurePercentage.requestVolume value.
Detection also will not be performed for a cluster if the number of hosts
with the minimum required request volume in an interval is less than the
outlierDetection.detectors.failurePercentage.minimumHosts value. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--failure_percentage))
- `gateway_failures` (Attributes) In the default mode (outlierDetection.splitExternalLocalOriginErrors is
false) this detection type takes into account a subset of 5xx errors,
called "gateway errors" (502, 503 or 504 status code) and local origin
failures, such as timeout, TCP reset etc.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account a subset of 5xx errors, called
"gateway errors" (502, 503 or 504 status code) and is supported only by
the http router. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--gateway_failures))
- `local_origin_failures` (Attributes) This detection type is enabled only when
outlierDetection.splitExternalLocalOriginErrors is true and takes into
account only locally originated errors (timeout, reset, etc).
If Envoy repeatedly cannot connect to an upstream host or communication
with the upstream host is repeatedly interrupted, it will be ejected.
Various locally originated problems are detected: timeout, TCP reset,
ICMP errors, etc. This detection type is supported by http router and
tcp proxy. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--local_origin_failures))
- `success_rate` (Attributes) Success Rate based outlier detection aggregates success rate data from
every host in a cluster. Then at given intervals ejects hosts based on
statistical outlier detection. Success Rate outlier detection will not be
calculated for a host if its request volume over the aggregation interval
is less than the outlierDetection.detectors.successRate.requestVolume
value.
Moreover, detection will not be performed for a cluster if the number of
hosts with the minimum required request volume in an interval is less
than the outlierDetection.detectors.successRate.minimumHosts value.
In the default configuration mode
(outlierDetection.splitExternalLocalOriginErrors is false) this detection
type takes into account all types of errors: locally and externally
originated.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true),
locally originated errors and externally originated (transaction) errors
are counted and treated separately. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--success_rate))
- `total_failures` (Attributes) In the default mode (outlierDetection.splitExternalAndLocalErrors is
false) this detection type takes into account all generated errors:
locally originated and externally originated (transaction) errors.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account only externally originated
(transaction) errors, ignoring locally originated errors.
If an upstream host is an HTTP-server, only 5xx types of error are taken
into account (see Consecutive Gateway Failure for exceptions).
Properly formatted responses, even when they carry an operational error
(like index not found, access denied) are not taken into account. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--total_failures))

<a id="nestedatt--spec--from--default--outlier_detection--detectors--failure_percentage"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.failure_percentage`

Optional:

- `minimum_hosts` (Number) The minimum number of hosts in a cluster in order to perform failure
percentage-based ejection. If the total number of hosts in the cluster is
less than this value, failure percentage-based ejection will not be
performed.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration above) to perform failure
percentage-based ejection for this host. If the volume is lower than this
setting, failure percentage-based ejection will not be performed for this
host.
- `threshold` (Number) The failure percentage to use when determining failure percentage-based
outlier detection. If the failure percentage of a given host is greater
than or equal to this value, it will be ejected.


<a id="nestedatt--spec--from--default--outlier_detection--detectors--gateway_failures"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.gateway_failures`

Optional:

- `consecutive` (Number) The number of consecutive gateway failures (502, 503, 504 status codes)
before a consecutive gateway failure ejection occurs.


<a id="nestedatt--spec--from--default--outlier_detection--detectors--local_origin_failures"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.local_origin_failures`

Optional:

- `consecutive` (Number) The number of consecutive locally originated failures before ejection
occurs. Parameter takes effect only when splitExternalAndLocalErrors
is set to true.


<a id="nestedatt--spec--from--default--outlier_detection--detectors--success_rate"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.success_rate`

Optional:

- `minimum_hosts` (Number) The number of hosts in a cluster that must have enough request volume to
detect success rate outliers. If the number of hosts is less than this
setting, outlier detection via success rate statistics is not performed
for any host in the cluster.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration configured in
outlierDetection section) to include this host in success rate based
outlier detection. If the volume is lower than this setting, outlier
detection via success rate statistics is not performed for that host.
- `standard_deviation_factor` (Attributes) This factor is used to determine the ejection threshold for success rate
outlier ejection. The ejection threshold is the difference between
the mean success rate, and the product of this factor and the standard
deviation of the mean success rate: mean - (standard_deviation *
success_rate_standard_deviation_factor).
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--from--default--outlier_detection--detectors--success_rate--standard_deviation_factor))

<a id="nestedatt--spec--from--default--outlier_detection--detectors--success_rate--standard_deviation_factor"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.success_rate.standard_deviation_factor`

Optional:

- `integer` (Number)
- `str` (String)



<a id="nestedatt--spec--from--default--outlier_detection--detectors--total_failures"></a>
### Nested Schema for `spec.from.default.outlier_detection.detectors.total_failures`

Optional:

- `consecutive` (Number) The number of consecutive server-side error responses (for HTTP traffic,
5xx responses; for TCP traffic, connection failures; for Redis, failure
to respond PONG; etc.) before a consecutive total failure ejection
occurs.



<a id="nestedatt--spec--from--default--outlier_detection--healthy_panic_threshold"></a>
### Nested Schema for `spec.from.default.outlier_detection.healthy_panic_threshold`

Optional:

- `integer` (Number)
- `str` (String)




<a id="nestedatt--spec--from--target_ref"></a>
### Nested Schema for `spec.from.target_ref`

Optional:

- `kind` (String) Kind of the referenced resource. Not Null; must be one of ["Mesh", "MeshSubset", "MeshGateway", "MeshService", "MeshExternalService", "MeshMultiZoneService", "MeshServiceSubset", "MeshHTTPRoute", "Dataplane"]
- `labels` (Map of String) Labels are used to select group of MeshServices that match labels. Either Labels or
Name and Namespace can be used.
- `mesh` (String) Mesh is reserved for future use to identify cross mesh resources.
- `name` (String) Name of the referenced resource. Can only be used with kinds: `MeshService`,
`MeshServiceSubset` and `MeshGatewayRoute`
- `namespace` (String) Namespace specifies the namespace of target resource. If empty only resources in policy namespace
will be targeted.
- `proxy_types` (List of String) ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
all data plane types are targeted by the policy.
- `section_name` (String) SectionName is used to target specific section of resource.
For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
- `tags` (Map of String) Tags used to select a subset of proxies by tags. Can only be used with kinds
`MeshSubset` and `MeshServiceSubset`



<a id="nestedatt--spec--rules"></a>
### Nested Schema for `spec.rules`

Optional:

- `default` (Attributes) Default contains configuration of the inbound circuit breaker (see [below for nested schema](#nestedatt--spec--rules--default))

<a id="nestedatt--spec--rules--default"></a>
### Nested Schema for `spec.rules.default`

Optional:

- `connection_limits` (Attributes) ConnectionLimits contains configuration of each circuit breaking limit,
which when exceeded makes the circuit breaker to become open (no traffic
is allowed like no current is allowed in the circuits when physical
circuit breaker ir open) (see [below for nested schema](#nestedatt--spec--rules--default--connection_limits))
- `outlier_detection` (Attributes) OutlierDetection contains the configuration of the process of dynamically
determining whether some number of hosts in an upstream cluster are
performing unlike the others and removing them from the healthy load
balancing set. Performance might be along different axes such as
consecutive failures, temporal success rate, temporal latency, etc.
Outlier detection is a form of passive health checking. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection))

<a id="nestedatt--spec--rules--default--connection_limits"></a>
### Nested Schema for `spec.rules.default.connection_limits`

Optional:

- `max_connection_pools` (Number) The maximum number of connection pools per cluster that are concurrently
supported at once. Set this for clusters which create a large number of
connection pools.
- `max_connections` (Number) The maximum number of connections allowed to be made to the upstream
cluster.
- `max_pending_requests` (Number) The maximum number of pending requests that are allowed to the upstream
cluster. This limit is applied as a connection limit for non-HTTP
traffic.
- `max_requests` (Number) The maximum number of parallel requests that are allowed to be made
to the upstream cluster. This limit does not apply to non-HTTP traffic.
- `max_retries` (Number) The maximum number of parallel retries that will be allowed to
the upstream cluster.


<a id="nestedatt--spec--rules--default--outlier_detection"></a>
### Nested Schema for `spec.rules.default.outlier_detection`

Optional:

- `base_ejection_time` (String) The base time that a host is ejected for. The real time is equal to
the base time multiplied by the number of times the host has been
ejected.
- `detectors` (Attributes) Contains configuration for supported outlier detectors (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors))
- `disabled` (Boolean) When set to true, outlierDetection configuration won't take any effect
- `healthy_panic_threshold` (Attributes) Allows to configure panic threshold for Envoy cluster. If not specified,
the default is 50%. To disable panic mode, set to 0%.
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--healthy_panic_threshold))
- `interval` (String) The time interval between ejection analysis sweeps. This can result in
both new ejections and hosts being returned to service.
- `max_ejection_percent` (Number) The maximum % of an upstream cluster that can be ejected due to outlier
detection. Defaults to 10% but will eject at least one host regardless of
the value.
- `split_external_and_local_errors` (Boolean) Determines whether to distinguish local origin failures from external
errors. If set to true the following configuration parameters are taken
into account: detectors.localOriginFailures.consecutive

<a id="nestedatt--spec--rules--default--outlier_detection--detectors"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors`

Optional:

- `failure_percentage` (Attributes) Failure Percentage based outlier detection functions similarly to success
rate detection, in that it relies on success rate data from each host in
a cluster. However, rather than compare those values to the mean success
rate of the cluster as a whole, they are compared to a flat
user-configured threshold. This threshold is configured via the
outlierDetection.failurePercentageThreshold field.
The other configuration fields for failure percentage based detection are
similar to the fields for success rate detection. As with success rate
detection, detection will not be performed for a host if its request
volume over the aggregation interval is less than the
outlierDetection.detectors.failurePercentage.requestVolume value.
Detection also will not be performed for a cluster if the number of hosts
with the minimum required request volume in an interval is less than the
outlierDetection.detectors.failurePercentage.minimumHosts value. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--failure_percentage))
- `gateway_failures` (Attributes) In the default mode (outlierDetection.splitExternalLocalOriginErrors is
false) this detection type takes into account a subset of 5xx errors,
called "gateway errors" (502, 503 or 504 status code) and local origin
failures, such as timeout, TCP reset etc.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account a subset of 5xx errors, called
"gateway errors" (502, 503 or 504 status code) and is supported only by
the http router. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--gateway_failures))
- `local_origin_failures` (Attributes) This detection type is enabled only when
outlierDetection.splitExternalLocalOriginErrors is true and takes into
account only locally originated errors (timeout, reset, etc).
If Envoy repeatedly cannot connect to an upstream host or communication
with the upstream host is repeatedly interrupted, it will be ejected.
Various locally originated problems are detected: timeout, TCP reset,
ICMP errors, etc. This detection type is supported by http router and
tcp proxy. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--local_origin_failures))
- `success_rate` (Attributes) Success Rate based outlier detection aggregates success rate data from
every host in a cluster. Then at given intervals ejects hosts based on
statistical outlier detection. Success Rate outlier detection will not be
calculated for a host if its request volume over the aggregation interval
is less than the outlierDetection.detectors.successRate.requestVolume
value.
Moreover, detection will not be performed for a cluster if the number of
hosts with the minimum required request volume in an interval is less
than the outlierDetection.detectors.successRate.minimumHosts value.
In the default configuration mode
(outlierDetection.splitExternalLocalOriginErrors is false) this detection
type takes into account all types of errors: locally and externally
originated.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true),
locally originated errors and externally originated (transaction) errors
are counted and treated separately. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--success_rate))
- `total_failures` (Attributes) In the default mode (outlierDetection.splitExternalAndLocalErrors is
false) this detection type takes into account all generated errors:
locally originated and externally originated (transaction) errors.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account only externally originated
(transaction) errors, ignoring locally originated errors.
If an upstream host is an HTTP-server, only 5xx types of error are taken
into account (see Consecutive Gateway Failure for exceptions).
Properly formatted responses, even when they carry an operational error
(like index not found, access denied) are not taken into account. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--total_failures))

<a id="nestedatt--spec--rules--default--outlier_detection--detectors--failure_percentage"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.failure_percentage`

Optional:

- `minimum_hosts` (Number) The minimum number of hosts in a cluster in order to perform failure
percentage-based ejection. If the total number of hosts in the cluster is
less than this value, failure percentage-based ejection will not be
performed.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration above) to perform failure
percentage-based ejection for this host. If the volume is lower than this
setting, failure percentage-based ejection will not be performed for this
host.
- `threshold` (Number) The failure percentage to use when determining failure percentage-based
outlier detection. If the failure percentage of a given host is greater
than or equal to this value, it will be ejected.


<a id="nestedatt--spec--rules--default--outlier_detection--detectors--gateway_failures"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.gateway_failures`

Optional:

- `consecutive` (Number) The number of consecutive gateway failures (502, 503, 504 status codes)
before a consecutive gateway failure ejection occurs.


<a id="nestedatt--spec--rules--default--outlier_detection--detectors--local_origin_failures"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.local_origin_failures`

Optional:

- `consecutive` (Number) The number of consecutive locally originated failures before ejection
occurs. Parameter takes effect only when splitExternalAndLocalErrors
is set to true.


<a id="nestedatt--spec--rules--default--outlier_detection--detectors--success_rate"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.success_rate`

Optional:

- `minimum_hosts` (Number) The number of hosts in a cluster that must have enough request volume to
detect success rate outliers. If the number of hosts is less than this
setting, outlier detection via success rate statistics is not performed
for any host in the cluster.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration configured in
outlierDetection section) to include this host in success rate based
outlier detection. If the volume is lower than this setting, outlier
detection via success rate statistics is not performed for that host.
- `standard_deviation_factor` (Attributes) This factor is used to determine the ejection threshold for success rate
outlier ejection. The ejection threshold is the difference between
the mean success rate, and the product of this factor and the standard
deviation of the mean success rate: mean - (standard_deviation *
success_rate_standard_deviation_factor).
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--rules--default--outlier_detection--detectors--success_rate--standard_deviation_factor))

<a id="nestedatt--spec--rules--default--outlier_detection--detectors--success_rate--standard_deviation_factor"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.success_rate.standard_deviation_factor`

Optional:

- `integer` (Number)
- `str` (String)



<a id="nestedatt--spec--rules--default--outlier_detection--detectors--total_failures"></a>
### Nested Schema for `spec.rules.default.outlier_detection.detectors.total_failures`

Optional:

- `consecutive` (Number) The number of consecutive server-side error responses (for HTTP traffic,
5xx responses; for TCP traffic, connection failures; for Redis, failure
to respond PONG; etc.) before a consecutive total failure ejection
occurs.



<a id="nestedatt--spec--rules--default--outlier_detection--healthy_panic_threshold"></a>
### Nested Schema for `spec.rules.default.outlier_detection.healthy_panic_threshold`

Optional:

- `integer` (Number)
- `str` (String)





<a id="nestedatt--spec--target_ref"></a>
### Nested Schema for `spec.target_ref`

Required:

- `kind` (String) Kind of the referenced resource. must be one of ["Mesh", "MeshSubset", "MeshGateway", "MeshService", "MeshExternalService", "MeshMultiZoneService", "MeshServiceSubset", "MeshHTTPRoute", "Dataplane"]

Optional:

- `labels` (Map of String) Labels are used to select group of MeshServices that match labels. Either Labels or
Name and Namespace can be used.
- `mesh` (String) Mesh is reserved for future use to identify cross mesh resources.
- `name` (String) Name of the referenced resource. Can only be used with kinds: `MeshService`,
`MeshServiceSubset` and `MeshGatewayRoute`
- `namespace` (String) Namespace specifies the namespace of target resource. If empty only resources in policy namespace
will be targeted.
- `proxy_types` (List of String) ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
all data plane types are targeted by the policy.
- `section_name` (String) SectionName is used to target specific section of resource.
For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
- `tags` (Map of String) Tags used to select a subset of proxies by tags. Can only be used with kinds
`MeshSubset` and `MeshServiceSubset`


<a id="nestedatt--spec--to"></a>
### Nested Schema for `spec.to`

Optional:

- `default` (Attributes) Default is a configuration specific to the group of destinations
referenced in 'targetRef' (see [below for nested schema](#nestedatt--spec--to--default))
- `target_ref` (Attributes) TargetRef is a reference to the resource that represents a group of
destinations.
Not Null (see [below for nested schema](#nestedatt--spec--to--target_ref))

<a id="nestedatt--spec--to--default"></a>
### Nested Schema for `spec.to.default`

Optional:

- `connection_limits` (Attributes) ConnectionLimits contains configuration of each circuit breaking limit,
which when exceeded makes the circuit breaker to become open (no traffic
is allowed like no current is allowed in the circuits when physical
circuit breaker ir open) (see [below for nested schema](#nestedatt--spec--to--default--connection_limits))
- `outlier_detection` (Attributes) OutlierDetection contains the configuration of the process of dynamically
determining whether some number of hosts in an upstream cluster are
performing unlike the others and removing them from the healthy load
balancing set. Performance might be along different axes such as
consecutive failures, temporal success rate, temporal latency, etc.
Outlier detection is a form of passive health checking. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection))

<a id="nestedatt--spec--to--default--connection_limits"></a>
### Nested Schema for `spec.to.default.connection_limits`

Optional:

- `max_connection_pools` (Number) The maximum number of connection pools per cluster that are concurrently
supported at once. Set this for clusters which create a large number of
connection pools.
- `max_connections` (Number) The maximum number of connections allowed to be made to the upstream
cluster.
- `max_pending_requests` (Number) The maximum number of pending requests that are allowed to the upstream
cluster. This limit is applied as a connection limit for non-HTTP
traffic.
- `max_requests` (Number) The maximum number of parallel requests that are allowed to be made
to the upstream cluster. This limit does not apply to non-HTTP traffic.
- `max_retries` (Number) The maximum number of parallel retries that will be allowed to
the upstream cluster.


<a id="nestedatt--spec--to--default--outlier_detection"></a>
### Nested Schema for `spec.to.default.outlier_detection`

Optional:

- `base_ejection_time` (String) The base time that a host is ejected for. The real time is equal to
the base time multiplied by the number of times the host has been
ejected.
- `detectors` (Attributes) Contains configuration for supported outlier detectors (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors))
- `disabled` (Boolean) When set to true, outlierDetection configuration won't take any effect
- `healthy_panic_threshold` (Attributes) Allows to configure panic threshold for Envoy cluster. If not specified,
the default is 50%. To disable panic mode, set to 0%.
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--healthy_panic_threshold))
- `interval` (String) The time interval between ejection analysis sweeps. This can result in
both new ejections and hosts being returned to service.
- `max_ejection_percent` (Number) The maximum % of an upstream cluster that can be ejected due to outlier
detection. Defaults to 10% but will eject at least one host regardless of
the value.
- `split_external_and_local_errors` (Boolean) Determines whether to distinguish local origin failures from external
errors. If set to true the following configuration parameters are taken
into account: detectors.localOriginFailures.consecutive

<a id="nestedatt--spec--to--default--outlier_detection--detectors"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors`

Optional:

- `failure_percentage` (Attributes) Failure Percentage based outlier detection functions similarly to success
rate detection, in that it relies on success rate data from each host in
a cluster. However, rather than compare those values to the mean success
rate of the cluster as a whole, they are compared to a flat
user-configured threshold. This threshold is configured via the
outlierDetection.failurePercentageThreshold field.
The other configuration fields for failure percentage based detection are
similar to the fields for success rate detection. As with success rate
detection, detection will not be performed for a host if its request
volume over the aggregation interval is less than the
outlierDetection.detectors.failurePercentage.requestVolume value.
Detection also will not be performed for a cluster if the number of hosts
with the minimum required request volume in an interval is less than the
outlierDetection.detectors.failurePercentage.minimumHosts value. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--failure_percentage))
- `gateway_failures` (Attributes) In the default mode (outlierDetection.splitExternalLocalOriginErrors is
false) this detection type takes into account a subset of 5xx errors,
called "gateway errors" (502, 503 or 504 status code) and local origin
failures, such as timeout, TCP reset etc.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account a subset of 5xx errors, called
"gateway errors" (502, 503 or 504 status code) and is supported only by
the http router. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--gateway_failures))
- `local_origin_failures` (Attributes) This detection type is enabled only when
outlierDetection.splitExternalLocalOriginErrors is true and takes into
account only locally originated errors (timeout, reset, etc).
If Envoy repeatedly cannot connect to an upstream host or communication
with the upstream host is repeatedly interrupted, it will be ejected.
Various locally originated problems are detected: timeout, TCP reset,
ICMP errors, etc. This detection type is supported by http router and
tcp proxy. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--local_origin_failures))
- `success_rate` (Attributes) Success Rate based outlier detection aggregates success rate data from
every host in a cluster. Then at given intervals ejects hosts based on
statistical outlier detection. Success Rate outlier detection will not be
calculated for a host if its request volume over the aggregation interval
is less than the outlierDetection.detectors.successRate.requestVolume
value.
Moreover, detection will not be performed for a cluster if the number of
hosts with the minimum required request volume in an interval is less
than the outlierDetection.detectors.successRate.minimumHosts value.
In the default configuration mode
(outlierDetection.splitExternalLocalOriginErrors is false) this detection
type takes into account all types of errors: locally and externally
originated.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true),
locally originated errors and externally originated (transaction) errors
are counted and treated separately. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--success_rate))
- `total_failures` (Attributes) In the default mode (outlierDetection.splitExternalAndLocalErrors is
false) this detection type takes into account all generated errors:
locally originated and externally originated (transaction) errors.
In split mode (outlierDetection.splitExternalLocalOriginErrors is true)
this detection type takes into account only externally originated
(transaction) errors, ignoring locally originated errors.
If an upstream host is an HTTP-server, only 5xx types of error are taken
into account (see Consecutive Gateway Failure for exceptions).
Properly formatted responses, even when they carry an operational error
(like index not found, access denied) are not taken into account. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--total_failures))

<a id="nestedatt--spec--to--default--outlier_detection--detectors--failure_percentage"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.failure_percentage`

Optional:

- `minimum_hosts` (Number) The minimum number of hosts in a cluster in order to perform failure
percentage-based ejection. If the total number of hosts in the cluster is
less than this value, failure percentage-based ejection will not be
performed.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration above) to perform failure
percentage-based ejection for this host. If the volume is lower than this
setting, failure percentage-based ejection will not be performed for this
host.
- `threshold` (Number) The failure percentage to use when determining failure percentage-based
outlier detection. If the failure percentage of a given host is greater
than or equal to this value, it will be ejected.


<a id="nestedatt--spec--to--default--outlier_detection--detectors--gateway_failures"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.gateway_failures`

Optional:

- `consecutive` (Number) The number of consecutive gateway failures (502, 503, 504 status codes)
before a consecutive gateway failure ejection occurs.


<a id="nestedatt--spec--to--default--outlier_detection--detectors--local_origin_failures"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.local_origin_failures`

Optional:

- `consecutive` (Number) The number of consecutive locally originated failures before ejection
occurs. Parameter takes effect only when splitExternalAndLocalErrors
is set to true.


<a id="nestedatt--spec--to--default--outlier_detection--detectors--success_rate"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.success_rate`

Optional:

- `minimum_hosts` (Number) The number of hosts in a cluster that must have enough request volume to
detect success rate outliers. If the number of hosts is less than this
setting, outlier detection via success rate statistics is not performed
for any host in the cluster.
- `request_volume` (Number) The minimum number of total requests that must be collected in one
interval (as defined by the interval duration configured in
outlierDetection section) to include this host in success rate based
outlier detection. If the volume is lower than this setting, outlier
detection via success rate statistics is not performed for that host.
- `standard_deviation_factor` (Attributes) This factor is used to determine the ejection threshold for success rate
outlier ejection. The ejection threshold is the difference between
the mean success rate, and the product of this factor and the standard
deviation of the mean success rate: mean - (standard_deviation *
success_rate_standard_deviation_factor).
Either int or decimal represented as string. (see [below for nested schema](#nestedatt--spec--to--default--outlier_detection--detectors--success_rate--standard_deviation_factor))

<a id="nestedatt--spec--to--default--outlier_detection--detectors--success_rate--standard_deviation_factor"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.success_rate.standard_deviation_factor`

Optional:

- `integer` (Number)
- `str` (String)



<a id="nestedatt--spec--to--default--outlier_detection--detectors--total_failures"></a>
### Nested Schema for `spec.to.default.outlier_detection.detectors.total_failures`

Optional:

- `consecutive` (Number) The number of consecutive server-side error responses (for HTTP traffic,
5xx responses; for TCP traffic, connection failures; for Redis, failure
to respond PONG; etc.) before a consecutive total failure ejection
occurs.



<a id="nestedatt--spec--to--default--outlier_detection--healthy_panic_threshold"></a>
### Nested Schema for `spec.to.default.outlier_detection.healthy_panic_threshold`

Optional:

- `integer` (Number)
- `str` (String)




<a id="nestedatt--spec--to--target_ref"></a>
### Nested Schema for `spec.to.target_ref`

Optional:

- `kind` (String) Kind of the referenced resource. Not Null; must be one of ["Mesh", "MeshSubset", "MeshGateway", "MeshService", "MeshExternalService", "MeshMultiZoneService", "MeshServiceSubset", "MeshHTTPRoute", "Dataplane"]
- `labels` (Map of String) Labels are used to select group of MeshServices that match labels. Either Labels or
Name and Namespace can be used.
- `mesh` (String) Mesh is reserved for future use to identify cross mesh resources.
- `name` (String) Name of the referenced resource. Can only be used with kinds: `MeshService`,
`MeshServiceSubset` and `MeshGatewayRoute`
- `namespace` (String) Namespace specifies the namespace of target resource. If empty only resources in policy namespace
will be targeted.
- `proxy_types` (List of String) ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
all data plane types are targeted by the policy.
- `section_name` (String) SectionName is used to target specific section of resource.
For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
- `tags` (Map of String) Tags used to select a subset of proxies by tags. Can only be used with kinds
`MeshSubset` and `MeshServiceSubset`

## Import

Import is supported using the following syntax:

```shell
terraform import konnect_mesh_circuit_breaker.my_konnect_mesh_circuit_breaker "{ \"cp_id\": \"bf138ba2-c9b1-4229-b268-04d9d8a6410b\",  \"mesh\": \"\",  \"name\": \"\"}"
```
