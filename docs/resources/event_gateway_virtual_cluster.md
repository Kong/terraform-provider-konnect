---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_event_gateway_virtual_cluster Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  EventGatewayVirtualCluster Resource
---

# konnect_event_gateway_virtual_cluster (Resource)

EventGatewayVirtualCluster Resource

## Example Usage

```terraform
resource "konnect_event_gateway_virtual_cluster" "my_eventgatewayvirtualcluster" {
  acl_mode = "enforce_on_gateway"
  authentication = [
    {
      sasl_plain = {
        mediation = "passthrough"
        principals = [
          {
            password = "$${vault.env['MY_ENV_VAR']}"
            username = "...my_username..."
          }
        ]
      }
    }
  ]
  description = "...my_description..."
  destination = {
    id = "759b5471-3de4-485c-b7d3-6e8cb8929d81"
  }
  dns_label  = "vcluster-1"
  gateway_id = "9524ec7d-36d9-465d-a8c5-83a3c9390458"
  labels = {
    key = "value"
  }
  name = "...my_name..."
  namespace = {
    additional = {
      consumer_groups = [
        {
          glob = {
            glob = "...my_glob..."
          }
        }
      ]
      topics = [
        {
          exact_list = {
            conflict = "warn"
            exact_list = [
              {
                backend = "...my_backend..."
              }
            ]
          }
        }
      ]
    }
    mode   = "hide_prefix"
    prefix = "...my_prefix..."
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `acl_mode` (String) Configures whether or not ACL policies are enforced on the gateway.
- `enforce_on_gateway` means the gateway enforces its own ACL policies for this virtual cluster

  and does not forward ACL-related commands to the backend cluster.
  Note that if there are no ACL policies configured, all access is denied.
- `passthrough` tells the gateway to forward all ACL-related commands.
must be one of ["enforce_on_gateway", "passthrough"]
- `authentication` (Attributes List) How to handle authentication from clients.

It tries to authenticate with every rule sequentially one by one.
It succeeds on the first match, and fails if no rule matches. (see [below for nested schema](#nestedatt--authentication))
- `destination` (Attributes) The backend cluster associated with the virtual cluster.

Either `id` or `name` must be provided. Following changes to the backend cluster name won't affect the
reference, as the system will create the entities relationship by `id`. (see [below for nested schema](#nestedatt--destination))
- `dns_label` (String) The DNS label used in the bootstrap server URL to identify the virtual cluster when using SNI routing.
The format follows the RFC1035: 1-63 chars, lowercase alphanumeric or '-', must start and end with an alphanumeric character.
- `gateway_id` (String) The UUID of your Gateway.
- `name` (String) The name of the virtual cluster.

### Optional

- `description` (String) A human-readable description of the virtual cluster. Default: ""
- `labels` (Map of String) Labels store metadata of an entity that can be used for filtering an entity list or for searching across entity types. 

Keys must be of length 1-63 characters, and cannot start with "kong", "konnect", "mesh", "kic", or "_".
- `namespace` (Attributes) Namespace allows to implement multitenancy using a single backend cluster.
It allows to either hide or enforce a static prefix on resources (topics, consumer group IDs, transaction IDs). (see [below for nested schema](#nestedatt--namespace))

### Read-Only

- `created_at` (String) An ISO-8601 timestamp representation of entity creation date.
- `id` (String) The unique identifier of the virtual cluster.
- `updated_at` (String) An ISO-8601 timestamp representation of entity update date.

<a id="nestedatt--authentication"></a>
### Nested Schema for `authentication`

Optional:

- `anonymous` (Attributes) (see [below for nested schema](#nestedatt--authentication--anonymous))
- `oauth_bearer` (Attributes) Oauth Bearer authentication scheme for the virtual cluster. (see [below for nested schema](#nestedatt--authentication--oauth_bearer))
- `sasl_plain` (Attributes) SASL/PLAIN authentication scheme for the virtual cluster. (see [below for nested schema](#nestedatt--authentication--sasl_plain))
- `sasl_scram` (Attributes) SASL/SCRAM authentication scheme for the virtual cluster. (see [below for nested schema](#nestedatt--authentication--sasl_scram))

<a id="nestedatt--authentication--anonymous"></a>
### Nested Schema for `authentication.anonymous`


<a id="nestedatt--authentication--oauth_bearer"></a>
### Nested Schema for `authentication.oauth_bearer`

Optional:

- `claims_mapping` (Attributes) Maps JWT claims in the case when sub and scope are presented as different claims in your JWT token. (see [below for nested schema](#nestedatt--authentication--oauth_bearer--claims_mapping))
- `jwks` (Attributes) JSON Web Key Set configuration for verifying token signatures. (see [below for nested schema](#nestedatt--authentication--oauth_bearer--jwks))
- `mediation` (String) Methods to mediate authentication:
* passthrough - pass authentication from the client through proxy to the backend cluster without any kind of

  validation
* validate_forward - pass authentication from the client through proxy to the backend cluster.

  Proxy does the validation before forwarding it to the client.
* terminate - terminate authentication at the proxy level and originate authentication to the backend cluster

  using the configuration defined at BackendCluster's authentication.
  SASL auth is not originated if authentication on the backend_cluster is not configured.
Not Null; must be one of ["passthrough", "validate_forward", "terminate"]
- `validate` (Attributes) Validation rules. (see [below for nested schema](#nestedatt--authentication--oauth_bearer--validate))

<a id="nestedatt--authentication--oauth_bearer--claims_mapping"></a>
### Nested Schema for `authentication.oauth_bearer.claims_mapping`

Optional:

- `scope` (String) Maps the scope claim.
- `sub` (String) Maps the subject claim.


<a id="nestedatt--authentication--oauth_bearer--jwks"></a>
### Nested Schema for `authentication.oauth_bearer.jwks`

Optional:

- `cache_expiration` (String) Duration after which the gateway will fetch and cache JWKS. Default: "1h"
- `endpoint` (String) URL for JWKS endpoint. Not Null
- `timeout` (String) Total time from establishing connection to receive a response from JWKS endpoint. Default: "10s"


<a id="nestedatt--authentication--oauth_bearer--validate"></a>
### Nested Schema for `authentication.oauth_bearer.validate`

Optional:

- `audiences` (Attributes List) List of expected audience values. One of them has to match the audience claim in the token. (see [below for nested schema](#nestedatt--authentication--oauth_bearer--validate--audiences))
- `issuer` (String) Expected token issuer in the token.

<a id="nestedatt--authentication--oauth_bearer--validate--audiences"></a>
### Nested Schema for `authentication.oauth_bearer.validate.audiences`

Optional:

- `name` (String) Not Null




<a id="nestedatt--authentication--sasl_plain"></a>
### Nested Schema for `authentication.sasl_plain`

Optional:

- `mediation` (String) The mediation type for SASL/PLAIN authentication. Not Null; must be one of ["passthrough", "terminate"]
- `principals` (Attributes List) List of principals to be able to authenticate with, used with `terminate` mediation. (see [below for nested schema](#nestedatt--authentication--sasl_plain--principals))

<a id="nestedatt--authentication--sasl_plain--principals"></a>
### Nested Schema for `authentication.sasl_plain.principals`

Optional:

- `password` (String) A sensitive value containing the secret or a reference to a secret as a template string expression.
If the value is provided as plain text, it is encrypted at rest and omitted from API responses.
If provided as an expression, the expression itself is stored and returned by the API.
Not Null
- `username` (String) A literal value or a reference to an existing secret as a template string expression.
The value is stored and returned by the API as-is, not treated as sensitive information.
Not Null



<a id="nestedatt--authentication--sasl_scram"></a>
### Nested Schema for `authentication.sasl_scram`

Optional:

- `algorithm` (String) The algorithm used for SASL/SCRAM authentication. Not Null; must be one of ["sha256", "sha512"]



<a id="nestedatt--destination"></a>
### Nested Schema for `destination`

Optional:

- `id` (String) The unique identifier of the backend cluster.

Read-Only:

- `name` (String) The unique name of the backend cluster.


<a id="nestedatt--namespace"></a>
### Nested Schema for `namespace`

Required:

- `mode` (String) * hide_prefix - the configured prefix is hidden from clients for topics and IDs when reading.

  Created resources are written with the prefix on the backend cluster.
* enforce_prefix - the configured prefix remains visible to clients.

  Created resources must include the prefix or the request will fail.
must be one of ["hide_prefix", "enforce_prefix"]
- `prefix` (String) The namespace is differentiated by this chosen prefix.
For example, if the prefix is set to "analytics_" the topic named "analytics_user_clicks" is available to the clients
of the virtual cluster. Topics without the prefix will be ignored unless added via `additional.topics`.

Optional:

- `additional` (Attributes) (see [below for nested schema](#nestedatt--namespace--additional))

<a id="nestedatt--namespace--additional"></a>
### Nested Schema for `namespace.additional`

Optional:

- `consumer_groups` (Attributes List) Consumer group IDs to expose even if they don't start with the namespace prefix. (see [below for nested schema](#nestedatt--namespace--additional--consumer_groups))
- `topics` (Attributes List) Additional backend topics to expose even if they don't match the namespace prefix.
The topics are not affected by the hide/enforce prefix mode.
If the client tries to create a topic that matches this list, the request is rejected. (see [below for nested schema](#nestedatt--namespace--additional--topics))

<a id="nestedatt--namespace--additional--consumer_groups"></a>
### Nested Schema for `namespace.additional.consumer_groups`

Optional:

- `exact_list` (Attributes) (see [below for nested schema](#nestedatt--namespace--additional--consumer_groups--exact_list))
- `glob` (Attributes) (see [below for nested schema](#nestedatt--namespace--additional--consumer_groups--glob))

<a id="nestedatt--namespace--additional--consumer_groups--exact_list"></a>
### Nested Schema for `namespace.additional.consumer_groups.exact_list`

Optional:

- `exact_list` (Attributes List) (see [below for nested schema](#nestedatt--namespace--additional--consumer_groups--exact_list--exact_list))

<a id="nestedatt--namespace--additional--consumer_groups--exact_list--exact_list"></a>
### Nested Schema for `namespace.additional.consumer_groups.exact_list.exact_list`

Optional:

- `value` (String) Not Null



<a id="nestedatt--namespace--additional--consumer_groups--glob"></a>
### Nested Schema for `namespace.additional.consumer_groups.glob`

Optional:

- `glob` (String) Expose any id that matches this glob pattern (e.g., `my_id_*`). Not Null



<a id="nestedatt--namespace--additional--topics"></a>
### Nested Schema for `namespace.additional.topics`

Optional:

- `exact_list` (Attributes) (see [below for nested schema](#nestedatt--namespace--additional--topics--exact_list))
- `glob` (Attributes) (see [below for nested schema](#nestedatt--namespace--additional--topics--glob))

<a id="nestedatt--namespace--additional--topics--exact_list"></a>
### Nested Schema for `namespace.additional.topics.exact_list`

Optional:

- `conflict` (String) How to inform the user about conflicts where multiple backend topics would map to the same virtual topic name.
* warn - log in the Event Gateway logs. Additionally, it sets knep_namespace_topic_conflict to 1.
* ignore - do not do anything. It does not cause knep_namespace_topic_conflict metric to be set to 1.
Default: "warn"; must be one of ["warn", "ignore"]
- `exact_list` (Attributes List) Explicit allow-list of backend topic names. (see [below for nested schema](#nestedatt--namespace--additional--topics--exact_list--exact_list))

<a id="nestedatt--namespace--additional--topics--exact_list--exact_list"></a>
### Nested Schema for `namespace.additional.topics.exact_list.exact_list`

Optional:

- `backend` (String) Not Null



<a id="nestedatt--namespace--additional--topics--glob"></a>
### Nested Schema for `namespace.additional.topics.glob`

Optional:

- `conflict` (String) How to inform the user about conflicts where multiple backend topics would map to the same virtual topic name.
* warn - log in the Event Gateway logs. Additionally, it sets knep_namespace_topic_conflict to 1.
* ignore - do not do anything. It does not cause knep_namespace_topic_conflict metric to be set to 1.
Default: "warn"; must be one of ["warn", "ignore"]
- `glob` (String) Expose any backend topic that matches this glob pattern (e.g., `operations_data_*`). Not Null

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = konnect_event_gateway_virtual_cluster.my_konnect_event_gateway_virtual_cluster
  id = jsonencode({
    gateway_id = "9524ec7d-36d9-465d-a8c5-83a3c9390458"
    id = "..."
  })
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import konnect_event_gateway_virtual_cluster.my_konnect_event_gateway_virtual_cluster '{"gateway_id": "9524ec7d-36d9-465d-a8c5-83a3c9390458", "id": "..."}'
```
