---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "konnect_mesh Resource - terraform-provider-konnect"
subcategory: ""
description: |-
  Mesh Resource
---

# konnect_mesh (Resource)

Mesh Resource

## Example Usage

```terraform
resource "konnect_mesh" "my_mesh" {
  constraints = {
    dataplane_proxy = {
      requirements = [
        {
          tags = {
            key = "value",
          }
        }
      ]
      restrictions = [
        {
          tags = {
            key = "value",
          }
        }
      ]
    }
  }
  cp_id = "bf138ba2-c9b1-4229-b268-04d9d8a6410b"
  labels = {
    key = "value",
  }
  logging = {
    backends = [
      {
        conf = {
          # ...
        }
        format = "...my_format..."
        name   = "...my_name..."
        type   = "...my_type..."
      }
    ]
    default_backend = "...my_default_backend..."
  }
  mesh_services = {
    mode = {
      integer = 5
      str     = "...my_str..."
    }
  }
  metrics = {
    backends = [
      {
        conf = {
          # ...
        }
        name = "...my_name..."
        type = "...my_type..."
      }
    ]
    enabled_backend = "...my_enabled_backend..."
  }
  mtls = {
    backends = [
      {
        conf = {
          # ...
        }
        dp_cert = {
          request_timeout = {
            nanos   = 5
            seconds = 5
          }
          rotation = {
            expiration = "...my_expiration..."
          }
        }
        mode = {
          integer = 4
          str     = "...my_str..."
        }
        name = "...my_name..."
        root_chain = {
          request_timeout = {
            nanos   = 9
            seconds = 4
          }
        }
        type = "...my_type..."
      }
    ]
    enabled_backend = "...my_enabled_backend..."
    skip_validation = true
  }
  name = "...my_name..."
  networking = {
    outbound = {
      passthrough = {
        value = true
      }
    }
  }
  routing = {
    default_forbid_mesh_external_service_access = false
    locality_aware_load_balancing               = false
    zone_egress                                 = false
  }
  skip_creating_initial_policies = [
    "..."
  ]
  tracing = {
    backends = [
      {
        conf = {
          # ...
        }
        name = "...my_name..."
        sampling = {
          value = 9.31
        }
        type = "...my_type..."
      }
    ]
    default_backend = "...my_default_backend..."
  }
  type = "...my_type..."
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cp_id` (String) Id of the Konnect resource
- `name` (String) name of the Mesh
- `type` (String)

### Optional

- `constraints` (Attributes) Constraints that applies to the mesh and its entities (see [below for nested schema](#nestedatt--constraints))
- `labels` (Map of String)
- `logging` (Attributes) Logging settings.
+optional (see [below for nested schema](#nestedatt--logging))
- `mesh_services` (Attributes) (see [below for nested schema](#nestedatt--mesh_services))
- `metrics` (Attributes) Configuration for metrics collected and exposed by dataplanes.

Settings defined here become defaults for every dataplane in a given Mesh.
Additionally, it is also possible to further customize this configuration
for each dataplane individually using Dataplane resource.
+optional (see [below for nested schema](#nestedatt--metrics))
- `mtls` (Attributes) mTLS settings.
+optional (see [below for nested schema](#nestedatt--mtls))
- `networking` (Attributes) Networking settings of the mesh (see [below for nested schema](#nestedatt--networking))
- `routing` (Attributes) Routing settings of the mesh (see [below for nested schema](#nestedatt--routing))
- `skip_creating_initial_policies` (List of String) List of policies to skip creating by default when the mesh is created.
e.g. TrafficPermission, MeshRetry, etc. An '*' can be used to skip all
policies.
- `tracing` (Attributes) Tracing settings.
+optional (see [below for nested schema](#nestedatt--tracing))

### Read-Only

- `warnings` (List of String) warnings is a list of warning messages to return to the requesting Kuma API clients.
Warning messages describe a problem the client making the API request should correct or be aware of.

<a id="nestedatt--constraints"></a>
### Nested Schema for `constraints`

Optional:

- `dataplane_proxy` (Attributes) DataplaneProxyMembership defines a set of requirements for data plane
proxies to be a member of the mesh. (see [below for nested schema](#nestedatt--constraints--dataplane_proxy))

<a id="nestedatt--constraints--dataplane_proxy"></a>
### Nested Schema for `constraints.dataplane_proxy`

Optional:

- `requirements` (Attributes List) Requirements defines a set of requirements that data plane proxies must
fulfill in order to join the mesh. A data plane proxy must fulfill at
least one requirement in order to join the mesh. Empty list of allowed
requirements means that any proxy that is not explicitly denied can join. (see [below for nested schema](#nestedatt--constraints--dataplane_proxy--requirements))
- `restrictions` (Attributes List) Restrictions defines a set of restrictions that data plane proxies cannot
fulfill in order to join the mesh. A data plane proxy cannot fulfill any
requirement in order to join the mesh.
Restrictions takes precedence over requirements. (see [below for nested schema](#nestedatt--constraints--dataplane_proxy--restrictions))

<a id="nestedatt--constraints--dataplane_proxy--requirements"></a>
### Nested Schema for `constraints.dataplane_proxy.requirements`

Optional:

- `tags` (Map of String) Tags defines set of required tags. You can specify '*' in value to
require non empty value of tag


<a id="nestedatt--constraints--dataplane_proxy--restrictions"></a>
### Nested Schema for `constraints.dataplane_proxy.restrictions`

Optional:

- `tags` (Map of String) Tags defines set of required tags. You can specify '*' in value to
require non empty value of tag




<a id="nestedatt--logging"></a>
### Nested Schema for `logging`

Optional:

- `backends` (Attributes List) List of available logging backends (see [below for nested schema](#nestedatt--logging--backends))
- `default_backend` (String) Name of the default backend

<a id="nestedatt--logging--backends"></a>
### Nested Schema for `logging.backends`

Optional:

- `conf` (Attributes) Configuration of the backend (see [below for nested schema](#nestedatt--logging--backends--conf))
- `format` (String) Format of access logs. Placeholders available on
https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log
- `name` (String) Name of the backend, can be then used in Mesh.logging.defaultBackend or in
TrafficLogging
- `type` (String) Type of the backend (Kuma ships with 'tcp' and 'file')

<a id="nestedatt--logging--backends--conf"></a>
### Nested Schema for `logging.backends.conf`




<a id="nestedatt--mesh_services"></a>
### Nested Schema for `mesh_services`

Optional:

- `mode` (Attributes) (see [below for nested schema](#nestedatt--mesh_services--mode))

<a id="nestedatt--mesh_services--mode"></a>
### Nested Schema for `mesh_services.mode`

Optional:

- `integer` (Number)
- `str` (String)



<a id="nestedatt--metrics"></a>
### Nested Schema for `metrics`

Optional:

- `backends` (Attributes List) List of available Metrics backends (see [below for nested schema](#nestedatt--metrics--backends))
- `enabled_backend` (String) Name of the enabled backend

<a id="nestedatt--metrics--backends"></a>
### Nested Schema for `metrics.backends`

Optional:

- `conf` (Attributes) Configuration of the backend (see [below for nested schema](#nestedatt--metrics--backends--conf))
- `name` (String) Name of the backend, can be then used in Mesh.metrics.enabledBackend
- `type` (String) Type of the backend (Kuma ships with 'prometheus')

<a id="nestedatt--metrics--backends--conf"></a>
### Nested Schema for `metrics.backends.conf`




<a id="nestedatt--mtls"></a>
### Nested Schema for `mtls`

Optional:

- `backends` (Attributes List) List of available Certificate Authority backends (see [below for nested schema](#nestedatt--mtls--backends))
- `enabled_backend` (String) Name of the enabled backend
- `skip_validation` (Boolean) If enabled, skips CA validation.

<a id="nestedatt--mtls--backends"></a>
### Nested Schema for `mtls.backends`

Optional:

- `conf` (Attributes) Configuration of the backend (see [below for nested schema](#nestedatt--mtls--backends--conf))
- `dp_cert` (Attributes) Dataplane certificate settings (see [below for nested schema](#nestedatt--mtls--backends--dp_cert))
- `mode` (Attributes) Mode defines the behaviour of inbound listeners with regard to traffic
encryption (see [below for nested schema](#nestedatt--mtls--backends--mode))
- `name` (String) Name of the backend
- `root_chain` (Attributes) (see [below for nested schema](#nestedatt--mtls--backends--root_chain))
- `type` (String) Type of the backend. Has to be one of the loaded plugins (Kuma ships with
builtin and provided)

<a id="nestedatt--mtls--backends--conf"></a>
### Nested Schema for `mtls.backends.conf`


<a id="nestedatt--mtls--backends--dp_cert"></a>
### Nested Schema for `mtls.backends.dp_cert`

Optional:

- `request_timeout` (Attributes) Timeout on request to CA for DP certificate generation and retrieval (see [below for nested schema](#nestedatt--mtls--backends--dp_cert--request_timeout))
- `rotation` (Attributes) Rotation settings (see [below for nested schema](#nestedatt--mtls--backends--dp_cert--rotation))

<a id="nestedatt--mtls--backends--dp_cert--request_timeout"></a>
### Nested Schema for `mtls.backends.dp_cert.request_timeout`

Optional:

- `nanos` (Number)
- `seconds` (Number)


<a id="nestedatt--mtls--backends--dp_cert--rotation"></a>
### Nested Schema for `mtls.backends.dp_cert.rotation`

Optional:

- `expiration` (String) Time after which generated certificate for Dataplane will expire



<a id="nestedatt--mtls--backends--mode"></a>
### Nested Schema for `mtls.backends.mode`

Optional:

- `integer` (Number)
- `str` (String)


<a id="nestedatt--mtls--backends--root_chain"></a>
### Nested Schema for `mtls.backends.root_chain`

Optional:

- `request_timeout` (Attributes) Timeout on request for to CA for root certificate chain.
If not specified, defaults to 10s. (see [below for nested schema](#nestedatt--mtls--backends--root_chain--request_timeout))

<a id="nestedatt--mtls--backends--root_chain--request_timeout"></a>
### Nested Schema for `mtls.backends.root_chain.request_timeout`

Optional:

- `nanos` (Number)
- `seconds` (Number)





<a id="nestedatt--networking"></a>
### Nested Schema for `networking`

Optional:

- `outbound` (Attributes) Outbound settings (see [below for nested schema](#nestedatt--networking--outbound))

<a id="nestedatt--networking--outbound"></a>
### Nested Schema for `networking.outbound`

Optional:

- `passthrough` (Attributes) Control the passthrough cluster (see [below for nested schema](#nestedatt--networking--outbound--passthrough))

<a id="nestedatt--networking--outbound--passthrough"></a>
### Nested Schema for `networking.outbound.passthrough`

Optional:

- `value` (Boolean)




<a id="nestedatt--routing"></a>
### Nested Schema for `routing`

Optional:

- `default_forbid_mesh_external_service_access` (Boolean) If true, blocks traffic to MeshExternalServices.
Default: false
- `locality_aware_load_balancing` (Boolean) Enable the Locality Aware Load Balancing
- `zone_egress` (Boolean) Enable routing traffic to services in other zone or external services
through ZoneEgress. Default: false


<a id="nestedatt--tracing"></a>
### Nested Schema for `tracing`

Optional:

- `backends` (Attributes List) List of available tracing backends (see [below for nested schema](#nestedatt--tracing--backends))
- `default_backend` (String) Name of the default backend

<a id="nestedatt--tracing--backends"></a>
### Nested Schema for `tracing.backends`

Optional:

- `conf` (Attributes) Configuration of the backend (see [below for nested schema](#nestedatt--tracing--backends--conf))
- `name` (String) Name of the backend, can be then used in Mesh.tracing.defaultBackend or in
TrafficTrace
- `sampling` (Attributes) Percentage of traces that will be sent to the backend (range 0.0 - 100.0).
Empty value defaults to 100.0% (see [below for nested schema](#nestedatt--tracing--backends--sampling))
- `type` (String) Type of the backend (Kuma ships with 'zipkin')

<a id="nestedatt--tracing--backends--conf"></a>
### Nested Schema for `tracing.backends.conf`


<a id="nestedatt--tracing--backends--sampling"></a>
### Nested Schema for `tracing.backends.sampling`

Optional:

- `value` (Number)

## Import

Import is supported using the following syntax:

```shell
terraform import konnect_mesh.my_konnect_mesh "{ \"cp_id\": \"bf138ba2-c9b1-4229-b268-04d9d8a6410b\",  \"name\": \"\"}"
```
