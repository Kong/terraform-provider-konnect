// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"errors"
	"fmt"
	"github.com/kong/terraform-provider-konnect/v3/internal/sdk/internal/utils"
)

type PrivateDNSAttachmentConfigType string

const (
	PrivateDNSAttachmentConfigTypeAwsPrivateHostedZoneAttachmentConfig  PrivateDNSAttachmentConfigType = "AwsPrivateHostedZoneAttachmentConfig"
	PrivateDNSAttachmentConfigTypeAwsPrivateDNSResolverAttachmentConfig PrivateDNSAttachmentConfigType = "AwsPrivateDnsResolverAttachmentConfig"
	PrivateDNSAttachmentConfigTypeGcpPrivateHostedZoneAttachmentConfig  PrivateDNSAttachmentConfigType = "GcpPrivateHostedZoneAttachmentConfig"
)

type PrivateDNSAttachmentConfig struct {
	AwsPrivateHostedZoneAttachmentConfig  *AwsPrivateHostedZoneAttachmentConfig  `queryParam:"inline" union:"member"`
	AwsPrivateDNSResolverAttachmentConfig *AwsPrivateDNSResolverAttachmentConfig `queryParam:"inline" union:"member"`
	GcpPrivateHostedZoneAttachmentConfig  *GcpPrivateHostedZoneAttachmentConfig  `queryParam:"inline" union:"member"`

	Type PrivateDNSAttachmentConfigType
}

func CreatePrivateDNSAttachmentConfigAwsPrivateHostedZoneAttachmentConfig(awsPrivateHostedZoneAttachmentConfig AwsPrivateHostedZoneAttachmentConfig) PrivateDNSAttachmentConfig {
	typ := PrivateDNSAttachmentConfigTypeAwsPrivateHostedZoneAttachmentConfig

	return PrivateDNSAttachmentConfig{
		AwsPrivateHostedZoneAttachmentConfig: &awsPrivateHostedZoneAttachmentConfig,
		Type:                                 typ,
	}
}

func CreatePrivateDNSAttachmentConfigAwsPrivateDNSResolverAttachmentConfig(awsPrivateDNSResolverAttachmentConfig AwsPrivateDNSResolverAttachmentConfig) PrivateDNSAttachmentConfig {
	typ := PrivateDNSAttachmentConfigTypeAwsPrivateDNSResolverAttachmentConfig

	return PrivateDNSAttachmentConfig{
		AwsPrivateDNSResolverAttachmentConfig: &awsPrivateDNSResolverAttachmentConfig,
		Type:                                  typ,
	}
}

func CreatePrivateDNSAttachmentConfigGcpPrivateHostedZoneAttachmentConfig(gcpPrivateHostedZoneAttachmentConfig GcpPrivateHostedZoneAttachmentConfig) PrivateDNSAttachmentConfig {
	typ := PrivateDNSAttachmentConfigTypeGcpPrivateHostedZoneAttachmentConfig

	return PrivateDNSAttachmentConfig{
		GcpPrivateHostedZoneAttachmentConfig: &gcpPrivateHostedZoneAttachmentConfig,
		Type:                                 typ,
	}
}

func (u *PrivateDNSAttachmentConfig) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var awsPrivateHostedZoneAttachmentConfig AwsPrivateHostedZoneAttachmentConfig = AwsPrivateHostedZoneAttachmentConfig{}
	if err := utils.UnmarshalJSON(data, &awsPrivateHostedZoneAttachmentConfig, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  PrivateDNSAttachmentConfigTypeAwsPrivateHostedZoneAttachmentConfig,
			Value: &awsPrivateHostedZoneAttachmentConfig,
		})
	}

	var awsPrivateDNSResolverAttachmentConfig AwsPrivateDNSResolverAttachmentConfig = AwsPrivateDNSResolverAttachmentConfig{}
	if err := utils.UnmarshalJSON(data, &awsPrivateDNSResolverAttachmentConfig, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  PrivateDNSAttachmentConfigTypeAwsPrivateDNSResolverAttachmentConfig,
			Value: &awsPrivateDNSResolverAttachmentConfig,
		})
	}

	var gcpPrivateHostedZoneAttachmentConfig GcpPrivateHostedZoneAttachmentConfig = GcpPrivateHostedZoneAttachmentConfig{}
	if err := utils.UnmarshalJSON(data, &gcpPrivateHostedZoneAttachmentConfig, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  PrivateDNSAttachmentConfigTypeGcpPrivateHostedZoneAttachmentConfig,
			Value: &gcpPrivateHostedZoneAttachmentConfig,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for PrivateDNSAttachmentConfig", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for PrivateDNSAttachmentConfig", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(PrivateDNSAttachmentConfigType)
	switch best.Type {
	case PrivateDNSAttachmentConfigTypeAwsPrivateHostedZoneAttachmentConfig:
		u.AwsPrivateHostedZoneAttachmentConfig = best.Value.(*AwsPrivateHostedZoneAttachmentConfig)
		return nil
	case PrivateDNSAttachmentConfigTypeAwsPrivateDNSResolverAttachmentConfig:
		u.AwsPrivateDNSResolverAttachmentConfig = best.Value.(*AwsPrivateDNSResolverAttachmentConfig)
		return nil
	case PrivateDNSAttachmentConfigTypeGcpPrivateHostedZoneAttachmentConfig:
		u.GcpPrivateHostedZoneAttachmentConfig = best.Value.(*GcpPrivateHostedZoneAttachmentConfig)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for PrivateDNSAttachmentConfig", string(data))
}

func (u PrivateDNSAttachmentConfig) MarshalJSON() ([]byte, error) {
	if u.AwsPrivateHostedZoneAttachmentConfig != nil {
		return utils.MarshalJSON(u.AwsPrivateHostedZoneAttachmentConfig, "", true)
	}

	if u.AwsPrivateDNSResolverAttachmentConfig != nil {
		return utils.MarshalJSON(u.AwsPrivateDNSResolverAttachmentConfig, "", true)
	}

	if u.GcpPrivateHostedZoneAttachmentConfig != nil {
		return utils.MarshalJSON(u.GcpPrivateHostedZoneAttachmentConfig, "", true)
	}

	return nil, errors.New("could not marshal union type PrivateDNSAttachmentConfig: all fields are null")
}

// CreatePrivateDNSRequest - Request schema for creating a Private DNS.
type CreatePrivateDNSRequest struct {
	// Human-readable name of the Private DNS.
	Name                       *string                     `json:"name,omitempty"`
	PrivateDNSAttachmentConfig *PrivateDNSAttachmentConfig `json:"private_dns_attachment_config,omitempty"`
}

func (c CreatePrivateDNSRequest) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CreatePrivateDNSRequest) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (c *CreatePrivateDNSRequest) GetName() *string {
	if c == nil {
		return nil
	}
	return c.Name
}

func (c *CreatePrivateDNSRequest) GetPrivateDNSAttachmentConfig() *PrivateDNSAttachmentConfig {
	if c == nil {
		return nil
	}
	return c.PrivateDNSAttachmentConfig
}
